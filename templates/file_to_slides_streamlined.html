<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document to Slides Converter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
        }

        body {
            background: #fafafa;
            min-height: 100vh;
        }

        .container-main {
            max-width: 680px;
            margin: 0 auto;
            padding: 24px;
        }

        .btn-primary {
            background: #18181b;
            color: white;
            transition: all 0.15s ease;
        }

        .btn-primary:hover:not(:disabled) {
            background: #27272a;
            transform: translateY(-1px);
        }

        .btn-primary:disabled {
            background: #d4d4d8;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: white;
            border: 1px solid #e4e4e7;
            color: #18181b;
            transition: all 0.15s ease;
        }

        .btn-secondary:hover {
            background: #f4f4f5;
            border-color: #d4d4d8;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #18181b;
            ring: 2px;
            ring-color: #18181b;
            ring-opacity: 0.1;
        }

        .advanced-toggle {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .advanced-toggle.open {
            max-height: 2000px;
        }

        .spinner {
            border: 3px solid #f4f4f5;
            border-top: 3px solid #18181b;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .badge {
            display: inline-flex;
            align-items: center;
            padding: 2px 8px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-radius: 4px;
        }

        .badge-new {
            background: #18181b;
            color: white;
        }

        .badge-optional {
            background: #f4f4f5;
            color: #71717a;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</head>
<body>
    <div class="container-main">
        <!-- Header -->
        <header class="text-center mb-12 mt-8">
            <h1 class="text-4xl font-bold text-zinc-900 mb-3">Document to Slides</h1>
            <p class="text-lg text-zinc-600">Convert Google Docs into presentations with AI</p>
        </header>

        <!-- Main Form -->
        <form id="upload-form" enctype="multipart/form-data">
            <!-- Step 1: Choose Document -->
            <div class="bg-white rounded-2xl p-8 mb-6 shadow-sm border border-zinc-200">
                <div class="flex items-center gap-3 mb-6">
                    <div class="flex items-center justify-center w-8 h-8 rounded-full bg-zinc-900 text-white text-sm font-semibold">
                        1
                    </div>
                    <h2 class="text-xl font-semibold text-zinc-900">Choose Your Document</h2>
                </div>

                <!-- File Upload -->
                <div class="mb-5">
                    <label for="file-upload" class="block text-sm font-medium text-zinc-700 mb-2">
                        Upload Document
                    </label>
                    <input type="file" id="file-upload" name="file" accept=".docx,.txt,.pdf"
                           class="w-full px-4 py-3 border border-zinc-300 rounded-lg text-sm transition-all focus:border-zinc-900 focus:ring-1 focus:ring-zinc-900">
                    <p class="text-xs text-zinc-500 mt-1.5">Supports: Word (.docx), Text (.txt), PDF</p>
                </div>

                <div class="flex items-center gap-4 my-5">
                    <div class="flex-1 h-px bg-zinc-200"></div>
                    <span class="text-xs font-medium text-zinc-400 uppercase tracking-wide">or</span>
                    <div class="flex-1 h-px bg-zinc-200"></div>
                </div>

                <!-- Google Drive -->
                <button type="button" id="browse-drive-btn"
                        class="w-full px-5 py-4 border-2 border-dashed border-zinc-300 rounded-lg hover:border-zinc-400 hover:bg-zinc-50 transition-all text-center group">
                    <svg class="mx-auto h-8 w-8 text-zinc-400 group-hover:text-zinc-500 mb-2" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96z"/>
                    </svg>
                    <span class="text-sm font-medium text-zinc-700 group-hover:text-zinc-900">Browse Google Drive</span>
                </button>

                <div class="flex items-center gap-4 my-5">
                    <div class="flex-1 h-px bg-zinc-200"></div>
                    <span class="text-xs font-medium text-zinc-400 uppercase tracking-wide">or</span>
                    <div class="flex-1 h-px bg-zinc-200"></div>
                </div>

                <!-- URL Input -->
                <div>
                    <label for="google-docs-url" class="block text-sm font-medium text-zinc-700 mb-2">
                        Paste Google Docs URL
                    </label>
                    <input type="url" id="google-docs-url" name="google_docs_url"
                           class="w-full px-4 py-3 border border-zinc-300 rounded-lg text-sm transition-all focus:border-zinc-900 focus:ring-1 focus:ring-zinc-900"
                           placeholder="https://docs.google.com/document/d/...">
                    <p class="text-xs text-zinc-500 mt-1.5">Document must be public or shared with link access</p>
                </div>
            </div>

            <!-- Step 2: Quick Settings -->
            <div class="bg-white rounded-2xl p-8 mb-6 shadow-sm border border-zinc-200">
                <div class="flex items-center gap-3 mb-6">
                    <div class="flex items-center justify-center w-8 h-8 rounded-full bg-zinc-900 text-white text-sm font-semibold">
                        2
                    </div>
                    <h2 class="text-xl font-semibold text-zinc-900">Settings</h2>
                    <span class="badge badge-optional ml-auto">Optional</span>
                </div>

                <!-- Script Column -->
                <div class="mb-6">
                    <label for="script-column" class="block text-sm font-medium text-zinc-700 mb-2">
                        Script Source
                    </label>
                    <select id="script-column" name="script_column"
                            class="w-full px-4 py-3 border border-zinc-300 rounded-lg text-sm transition-all focus:border-zinc-900 focus:ring-1 focus:ring-zinc-900">
                        <option value="0" selected>No table - Use paragraphs</option>
                        <option value="1">Table Column 1</option>
                        <option value="2">Table Column 2</option>
                        <option value="3">Table Column 3</option>
                        <option value="4">Table Column 4</option>
                        <option value="5">Table Column 5</option>
                        <option value="6">Table Column 6</option>
                    </select>
                </div>

                <!-- AI Enhancement Toggle -->
                <div class="p-4 bg-zinc-50 rounded-lg border border-zinc-200">
                    <div class="flex items-start gap-3">
                        <input type="checkbox" id="enable-ai" class="mt-1 h-4 w-4 rounded border-zinc-300 text-zinc-900 focus:ring-zinc-900">
                        <div class="flex-1">
                            <label for="enable-ai" class="block text-sm font-medium text-zinc-900 cursor-pointer">
                                Enable AI Enhancement
                            </label>
                            <p class="text-xs text-zinc-600 mt-1">
                                Use Claude or OpenAI to improve bullet points and add visuals
                            </p>
                        </div>
                    </div>

                    <!-- AI Settings (shown when enabled) -->
                    <div id="ai-settings" class="advanced-toggle mt-4 pt-4 border-t border-zinc-200">
                        <div class="space-y-4">
                            <!-- API Key Input -->
                            <div>
                                <label for="claude-key" class="block text-xs font-medium text-zinc-700 mb-1.5">
                                    Claude API Key
                                </label>
                                <input type="password" id="claude-key" name="claude_key"
                                       class="w-full px-3 py-2 border border-zinc-300 rounded-lg text-sm transition-all focus:border-zinc-900"
                                       placeholder="sk-ant-...">
                                <p class="text-xs text-zinc-500 mt-1">
                                    Get free key at <a href="https://console.anthropic.com" target="_blank" class="underline hover:text-zinc-900">console.anthropic.com</a>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Advanced Settings Toggle -->
                <button type="button" id="advanced-toggle-btn"
                        class="flex items-center gap-2 text-sm font-medium text-zinc-600 hover:text-zinc-900 mt-6 transition-colors">
                    <svg class="w-4 h-4 transition-transform" id="advanced-toggle-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                    <span>Advanced Options</span>
                </button>

                <!-- Advanced Settings (collapsed by default) -->
                <div id="advanced-settings" class="advanced-toggle mt-4">
                    <div class="space-y-6 p-4 bg-zinc-50 rounded-lg">
                        <!-- OpenAI API Key -->
                        <div>
                            <label for="openai-key" class="block text-xs font-medium text-zinc-700 mb-1.5">
                                OpenAI API Key <span class="badge badge-optional ml-1">For Visuals</span>
                            </label>
                            <input type="password" id="openai-key" name="openai_key"
                                   class="w-full px-3 py-2 border border-zinc-300 rounded-lg text-sm"
                                   placeholder="sk-...">
                            <p class="text-xs text-zinc-500 mt-1">
                                Required for DALL-E image generation
                            </p>
                        </div>

                        <!-- Visual Generation -->
                        <div>
                            <div class="flex items-start gap-2">
                                <input type="checkbox" id="enable-visual-generation" name="enable_visual_generation"
                                       class="mt-1 h-4 w-4 rounded border-zinc-300 text-zinc-900">
                                <div>
                                    <label for="enable-visual-generation" class="text-sm font-medium text-zinc-700 cursor-pointer">
                                        Generate Images <span class="badge badge-new ml-1">New</span>
                                    </label>
                                    <p class="text-xs text-zinc-500 mt-0.5">Add AI-generated images to slides ($0.04-0.08 per image)</p>
                                </div>
                            </div>

                            <!-- Visual Settings -->
                            <div id="visual-settings" class="advanced-toggle mt-3 ml-6 space-y-3">
                                <div>
                                    <label for="visual-filter" class="block text-xs font-medium text-zinc-700 mb-1.5">
                                        Apply to
                                    </label>
                                    <select id="visual-filter" name="visual_filter"
                                            class="w-full px-3 py-2 border border-zinc-300 rounded-lg text-sm">
                                        <option value="key_slides" selected>Key slides only</option>
                                        <option value="all">All slides</option>
                                    </select>
                                </div>

                                <div class="flex gap-3">
                                    <label class="flex-1 flex items-center gap-2 px-3 py-2 border border-zinc-300 rounded-lg cursor-pointer hover:bg-zinc-50">
                                        <input type="radio" name="visual_quality" value="standard" checked class="h-4 w-4 text-zinc-900">
                                        <div>
                                            <div class="text-xs font-medium text-zinc-900">Standard</div>
                                            <div class="text-xs text-zinc-500">$0.04</div>
                                        </div>
                                    </label>
                                    <label class="flex-1 flex items-center gap-2 px-3 py-2 border border-zinc-300 rounded-lg cursor-pointer hover:bg-zinc-50">
                                        <input type="radio" name="visual_quality" value="hd" class="h-4 w-4 text-zinc-900">
                                        <div>
                                            <div class="text-xs font-medium text-zinc-900">HD</div>
                                            <div class="text-xs text-zinc-500">$0.08</div>
                                        </div>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Quality Refinement -->
                        <div class="flex items-start gap-2">
                            <input type="checkbox" id="enable-refinement" name="enable_refinement"
                                   class="mt-1 h-4 w-4 rounded border-zinc-300 text-zinc-900">
                            <div>
                                <label for="enable-refinement" class="text-sm font-medium text-zinc-700 cursor-pointer">
                                    Quality Refinement
                                </label>
                                <p class="text-xs text-zinc-500 mt-0.5">Second AI pass for better quality (+50% cost)</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Hidden Inputs -->
            <input type="hidden" name="api_mode" value="claude">
            <input type="hidden" name="output_format" value="google_slides">
            <input type="hidden" id="skip-visuals" name="skip_visuals" value="false">

            <!-- Submit Button -->
            <button type="submit" id="convert-btn" disabled
                    class="w-full btn-primary px-8 py-4 text-base font-semibold rounded-xl shadow-sm focus:ring-2 focus:ring-zinc-900 focus:ring-offset-2">
                Create Presentation
            </button>

            <p class="text-center text-xs text-zinc-500 mt-3">
                First select a document to continue
            </p>
        </form>

        <!-- Progress -->
        <div id="progress" class="hidden mt-8 bg-white rounded-2xl p-8 shadow-sm border border-zinc-200">
            <div class="flex items-center gap-4 mb-4">
                <div class="spinner"></div>
                <div class="flex-1">
                    <div id="progress-text" class="text-sm font-medium text-zinc-900">Converting your document...</div>
                    <div id="progress-subtitle" class="text-xs text-zinc-500 mt-1">This may take a few moments</div>
                </div>
                <div id="progress-percent" class="text-sm font-semibold text-zinc-900">0%</div>
            </div>
            <div class="w-full bg-zinc-100 rounded-full h-2 overflow-hidden">
                <div id="progress-bar" class="bg-zinc-900 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>
        </div>

        <!-- Results -->
        <div id="results" class="hidden mt-8 bg-white rounded-2xl p-8 shadow-sm border border-zinc-200">
            <div class="text-center mb-6">
                <div class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-emerald-100 mb-4">
                    <svg class="w-6 h-6 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                </div>
                <h3 class="text-xl font-semibold text-zinc-900 mb-2">Presentation Created!</h3>
                <p class="text-sm text-zinc-600">Your slides are ready</p>
            </div>

            <div id="download-link" class="text-center">
                <!-- Download/view links will be inserted here -->
            </div>

            <button type="button" onclick="location.reload()"
                    class="w-full btn-secondary px-6 py-3 text-sm font-medium rounded-lg mt-6">
                Create Another
            </button>
        </div>

        <!-- Help Text -->
        <div class="mt-12 p-6 bg-zinc-50 rounded-lg border border-zinc-200">
            <h4 class="text-sm font-semibold text-zinc-900 mb-3">Document Structure Tips</h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-xs text-zinc-600">
                <div>
                    <span class="font-medium text-zinc-900">H1:</span> Presentation title<br>
                    <span class="font-medium text-zinc-900">H2:</span> Section dividers
                </div>
                <div>
                    <span class="font-medium text-zinc-900">H3:</span> Subsection titles<br>
                    <span class="font-medium text-zinc-900">H4:</span> Slide titles
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Toggle AI settings
        document.getElementById('enable-ai').addEventListener('change', function(e) {
            const aiSettings = document.getElementById('ai-settings');
            if (e.target.checked) {
                aiSettings.classList.add('open');
            } else {
                aiSettings.classList.remove('open');
            }
        });

        // Toggle advanced settings
        document.getElementById('advanced-toggle-btn').addEventListener('click', function() {
            const advancedSettings = document.getElementById('advanced-settings');
            const icon = document.getElementById('advanced-toggle-icon');
            advancedSettings.classList.toggle('open');
            if (advancedSettings.classList.contains('open')) {
                icon.style.transform = 'rotate(180deg)';
            } else {
                icon.style.transform = 'rotate(0deg)';
            }
        });

        // Toggle visual generation settings
        document.getElementById('enable-visual-generation').addEventListener('change', function(e) {
            const visualSettings = document.getElementById('visual-settings');
            if (e.target.checked) {
                visualSettings.classList.add('open');
            } else {
                visualSettings.classList.remove('open');
            }
        });

        // Enable convert button when document is selected
        const fileInput = document.getElementById('file-upload');
        const urlInput = document.getElementById('google-docs-url');
        const convertBtn = document.getElementById('convert-btn');

        function checkFormValidity() {
            if (fileInput.files.length > 0 || urlInput.value.trim()) {
                convertBtn.disabled = false;
                convertBtn.nextElementSibling.textContent = 'Ready to convert';
            } else {
                convertBtn.disabled = true;
                convertBtn.nextElementSibling.textContent = 'First select a document to continue';
            }
        }

        fileInput.addEventListener('change', checkFormValidity);
        urlInput.addEventListener('input', checkFormValidity);

        // Note: Additional JavaScript from original file would be integrated here
        // This is a streamlined version focusing on UI/UX improvements
    </script>
</body>
</html>
